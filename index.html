
<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>ESP32 BLE æ’­æ”¾å½±ç‰‡</title>
  <style>
    body { font-family: sans-serif; text-align: center; margin-top: 50px; }
    video { width: 80%; margin-top: 20px; }
    button { padding: 10px 20px; font-size: 16px; margin: 10px; }
  </style>
</head>
<body>
  <h1>ğŸ“± ESP32 æ§åˆ¶æ’­æ”¾</h1>
  <button onclick="connectBLE()">é€£æ¥ ESP32</button>
  <video id="player" controls>
    <source src="video1.mp4" type="video/mp4">
    æ‚¨çš„ç€è¦½å™¨ä¸æ”¯æ´ HTML5 è¦–è¨Šæ’­æ”¾ã€‚
  </video>

  <script>
    let player = document.getElementById('player');

    async function connectBLE() {
      try {
        const device = await navigator.bluetooth.requestDevice({
          filters: [{ namePrefix: 'ESP32' }],
          optionalServices: ['12345678-1234-1234-1234-1234567890ab']
        });

        const server = await device.gatt.connect();
        const service = await server.getPrimaryService('12345678-1234-1234-1234-1234567890ab');
        const characteristic = await service.getCharacteristic('abcd1234-5678-90ab-cdef-1234567890ab');

        characteristic.startNotifications();
        characteristic.addEventListener('characteristicvaluechanged', (event) => {
          const value = new TextDecoder().decode(event.target.value);
          console.log("æ”¶åˆ° BLE è¨Šè™Ÿï¼š", value);

          if (value === "play_video_1") {
            player.src = "video1.mp4";
            player.play();
          } else if (value === "play_video_2") {
            player.src = "video2.mp4";
            player.play();
          }
        });

        alert("âœ… å·²é€£æ¥ ESP32ï¼Œç­‰å¾…æŒ‡ä»¤...");
      } catch (error) {
        alert("âŒ éŒ¯èª¤ï¼š" + error);
      }
    }
  </script>
</body>
</html>
